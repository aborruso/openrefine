# Hands On: Reconciliation

OpenRefine's *[Reconciliation](https://github.com/OpenRefine/OpenRefine/wiki/Reconciliation)* service is used to semi-automate the process of matching data in OpenRefine fields with more authoritative data in external sources.  This reconciliation function is called **semi**-autmated because the end-user is given the opportunity to interactively approve or select which data are modified by choosing from a pick-list of results. This process can be used to improve and standardize individual data fields or columns of data inside of OpenRefine.  Or it can be used to extend the data in OpenRefine.

> For example:  Match each name in a list of authors against an external authoritative list of authors. Augment the authoritative entry of each author's name; Add an example book title for each author.


## Reconciliation

**Goal** Import [new author data](https://github.com/libjohn/openrefine/blob/master/data/AA-authors-you-should-read.csv) into a new project, Use the WikiData and VIAF reconciliation services to gather authortive versions of author names and an example of each author's work.

1. Make a New Project, Import Author Data 

    - <span class="or-menu">Create Project  > Web Addresses (URLs) ></span> ` https://raw.githubusercontent.com/libjohn/openrefine/master/data/AA-authors-you-should-read.csv `
    - <span class="or-menu">Next >></span>  
    - You many want to give your project a pretty title
    - Create Project >>  
    
1. Make two copies of the authors column

    i.  <span class="or-menu">authors  > Edit Column > Add column based ont his column... </span>
    
        a. New column name  = ` author works Wikidata `
        b. <span class="or-menu"> > OK </span>
        
1. Repeat the above step two more times.  New column names should be:  ` authors viaf `

1. <span class="or-menu"> author works Wikidata > Reconcile > Start reconciling... </span>

    i. <span class="or-menu"> Add Standard Service... </span>
    i. In the **Enter the service's URL:** textbox, enter:  ` http://refine.codefork.com/reconcile/viaf `^[http://refine.codefork.com/]
    i.  Name = "Reconciled Authors"
    i. click VIAF
    i. Under *Reconcile each cell to an entity of one of these types:*, choose **Work**
    i. Click, <span class="or-menu">Start Reconciling</span>
    i. <span class="or-menu">author works Wikidata > Reconcile > Actions > Match each cell to its best candidate</span>

1. authors > Reconcile > Start reconcilling...

    a. One Time...
    a. documentation:  http://refine.codefork.com/
    b. Click:  `Add Standard Service ...`
    c. From the refine.codefork.com, use VIAF `http://refine.codefork.com/reconcile/viaf`  And if you use it a lot, read the documentation follow the install instructions:  https://github.com/codeforkjeff/refine_viaf
    d. Rest of Time...
    e. VIAF > Person > Start Reconciling
    f. reconciled authors > Reconcile > Actions > Match each cell to it's best candidate
    g. Choose New Match for James Baldwin
    h. Choose new match for Richard Wright > Create new item
    
    
3. Can Export as CSV (Excel, etc.) with Reconciled info.
4. Remove all facets
    
    
    
    

6. Convert 12PM to 00PM  
    + <span class="or-menu">date2 Edit cells > transform  </span>  
        + Expression = `value.replace(" 12:"," 00:")`

8. Now make a date facet  
    + <span class="or-menu">date2 > Facet > Timeline facet </span> 


## Lipsum More Foo Text  


**Goal**: Make the same data transformations as in the previous slide’s steps 2-7, but this time you’ll do it in one step.  Think about how GREL allows you to take shortcuts.


1. <span class="or-menu">issue_date > Edit Column > Add column based on this column…  </span> 
    + New Column Name = `date3`  
    + Expression = `if(value.slice(20,22) == "PM", value.replace(/(.*\s)12(:\d\d:.*)/,"$100$2"), value).toDate()`  
2. Now make a date facet  
    + <span class="or-menu">date3 > Facet > Timeline facet </span> 



## Reconciliation Resources

- YouTube:  [Reconcilliation in OpenRefine: Part 1](https://www.youtube.com/watch?v=q8ffvdeyuNQ) by Owen Stephens
- [Reconcilliation in OpenRefine part 2](https://www.youtube.com/watch?v=0tQPmfb6IFk)
- [Reconciliation Data Sources](https://github.com/OpenRefine/OpenRefine/wiki/Reconcilable-Data-Sources)
- For low use needs:  [VIAF / ORCID / Open Library](http://refine.codefork.com/)
- For more advanced needs:  [conciliator](https://github.com/codeforkjeff/conciliator#conciliator)
- [OpenRefine documentation on Reconciliation](https://github.com/OpenRefine/OpenRefine/wiki/Reconciliation)
- [OpenRefine technical documentation on reconciliation API](https://github.com/OpenRefine/OpenRefine/wiki/Reconciliation-Service-API)

